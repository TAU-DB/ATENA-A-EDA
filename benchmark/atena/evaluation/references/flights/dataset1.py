from atena.simulation.actions import (
    GroupAction,
    Column,
    AggregationFunction,
    BackAction,
    FilterAction,
    FilterOperator,
)

reference1 = [
    GroupAction(grouped_column=Column('departure_delay'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('origin_airport'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    FilterAction(filtered_column=Column('origin_airport'), filter_operator=FilterOperator.CONTAINS, filter_term='DFW'),
    BackAction(),
    BackAction(),
    GroupAction(grouped_column=Column('day_of_year'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
    BackAction(),
    GroupAction(grouped_column=Column('delay_reason'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('scheduled_departure'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('scheduled_trip_time'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
]

reference2 = [
    GroupAction(grouped_column=Column('origin_airport'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
    GroupAction(grouped_column=Column('departure_delay'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('origin_airport'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
    GroupAction(grouped_column=Column('flight_number'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
    BackAction(),
    BackAction(),
    GroupAction(grouped_column=Column('delay_reason'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('departure_delay'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('scheduled_departure'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
]

reference3 = [
    GroupAction(grouped_column=Column('origin_airport'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
    GroupAction(grouped_column=Column('scheduled_departure'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
    GroupAction(grouped_column=Column('departure_delay'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('day_of_year'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
    GroupAction(grouped_column=Column('delay_reason'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('origin_airport'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    FilterAction(filtered_column=Column('delay_reason'), filter_operator=FilterOperator.EQUAL,
                 filter_term='AIR_SYSTEM'),
    BackAction(),
    FilterAction(filtered_column=Column('origin_airport'), filter_operator=FilterOperator.EQUAL, filter_term='DFW'),
]

reference4 = [
    GroupAction(grouped_column=Column('departure_delay'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('scheduled_departure'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('origin_airport'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    FilterAction(filtered_column=Column('origin_airport'), filter_operator=FilterOperator.NOTEQUAL, filter_term='DFW'),
    BackAction(),
    BackAction(),
    GroupAction(grouped_column=Column('scheduled_trip_time'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('delay_reason'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
    BackAction(),
    GroupAction(grouped_column=Column('day_of_year'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
]


reference5 = [
    GroupAction(grouped_column=Column('departure_delay'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    FilterAction(filtered_column=Column('departure_delay'), filter_operator=FilterOperator.NOTEQUAL, filter_term='LARGE_DELAY'),
    GroupAction(grouped_column=Column('origin_airport'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    FilterAction(filtered_column=Column('origin_airport'), filter_operator=FilterOperator.EQUAL, filter_term='DFW'),
    GroupAction(grouped_column=Column('delay_reason'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('scheduled_departure'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
    BackAction(),
    GroupAction(grouped_column=Column('day_of_year'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
    BackAction(),
    BackAction(),
]


flights1_references = [reference1, reference2, reference3, reference4, reference5]

assert all([len(reference) == 12 for reference in flights1_references])
