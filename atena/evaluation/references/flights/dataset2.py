from atena.simulation.actions import (
    GroupAction,
    Column,
    AggregationFunction,
    BackAction,
    FilterAction,
    FilterOperator,
)

reference1 = [
    GroupAction(grouped_column=Column('airline'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
    GroupAction(grouped_column=Column('delay_reason'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('scheduled_trip_time'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('destination_airport'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
    GroupAction(grouped_column=Column('departure_delay'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('scheduled_departure'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
    GroupAction(grouped_column=Column('airline'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    FilterAction(filtered_column=Column('departure_delay'), filter_operator=FilterOperator.EQUAL,
                 filter_term='LARGE_DELAY'),
    BackAction(),
]

reference2 = [
    GroupAction(grouped_column=Column('delay_reason'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('airline'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
    GroupAction(grouped_column=Column('departure_delay'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('airline'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
    GroupAction(grouped_column=Column('destination_airport'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    FilterAction(filtered_column=Column('destination_airport'), filter_operator=FilterOperator.EQUAL,
                 filter_term='DCA'),
    BackAction(),
    BackAction(),
    GroupAction(grouped_column=Column('scheduled_trip_time'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('scheduled_departure'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
]

reference3 = [
    GroupAction(grouped_column=Column('departure_delay'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('delay_reason'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('scheduled_trip_time'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
    BackAction(),
    BackAction(),
    GroupAction(grouped_column=Column('airline'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('destination_airport'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('departure_delay'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    FilterAction(filtered_column=Column('destination_airport'), filter_operator=FilterOperator.EQUAL,
                 filter_term='DCA'),
    GroupAction(grouped_column=Column('scheduled_departure'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
]

reference4 = [
    GroupAction(grouped_column=Column('delay_reason'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('departure_delay'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    FilterAction(filtered_column=Column('departure_delay'), filter_operator=FilterOperator.CONTAINS,
                 filter_term='LARGE_DELAY'),
    GroupAction(grouped_column=Column('airline'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('scheduled_trip_time'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    FilterAction(filtered_column=Column('scheduled_trip_time'), filter_operator=FilterOperator.CONTAINS,
                 filter_term='SHORT_FLIGHT'),
    BackAction(),
    BackAction(),
    BackAction(),
    GroupAction(grouped_column=Column('destination_airport'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
    GroupAction(grouped_column=Column('day_of_week'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
]


reference5 = [
    GroupAction(grouped_column=Column('airline'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
    GroupAction(grouped_column=Column('delay_reason'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('scheduled_trip_time'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('destination_airport'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
    GroupAction(grouped_column=Column('departure_delay'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    GroupAction(grouped_column=Column('scheduled_departure'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    BackAction(),
    GroupAction(grouped_column=Column('airline'), aggregated_column=Column('flight_id'),
                aggregation_function=AggregationFunction.COUNT),
    FilterAction(filtered_column=Column('departure_delay'), filter_operator=FilterOperator.EQUAL,
                 filter_term='LARGE_DELAY'),
    BackAction(),
]


flights2_references = [reference1, reference2, reference3, reference4, reference5]

assert all([len(reference) == 12 for reference in flights2_references])
